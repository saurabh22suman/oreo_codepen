# ==================================
# Oreo CodePen - Development Configuration
# ==================================
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up --build
#
# Features:
#   - Hot-reload with nodemon
#   - Source code volume mounting
#   - Debug-friendly settings
#   - Exposed debug port

version: "3.8"

services:
  oreo-app:
    build:
      context: .
      dockerfile: Dockerfile
      target: development
    
    image: oreo-codepen:dev
    container_name: oreo-codepen-dev
    
    # Mount source code for hot-reload
    volumes:
      - .:/app
      - /app/node_modules  # Prevent node_modules from being overwritten
      - /var/run/docker.sock:/var/run/docker.sock
      - ./projects:/app/projects
    
    ports:
      - "${PORT:-3000}:3000"
      - "9229:9229"  # Node.js debug port
    
    environment:
      - NODE_ENV=development
      - DEBUG=*
    
    # Override command for debugging (optional)
    # command: ["node", "--inspect=0.0.0.0:9229", "server.js"]
    
    # Development doesn't need health checks slowing things down
    healthcheck:
      disable: true
